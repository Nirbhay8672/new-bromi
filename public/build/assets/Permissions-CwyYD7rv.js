import{d as z,r as m,o as G,n as I,c as a,a as l,b as D,u as L,h as W,w as q,e,f as v,g as o,F as w,i as S,t as r,j as x,k as C,l as E,v as H,m as J,p as k}from"./app-C8I2FI9v.js";import{_ as K,a as O}from"./StrikingDashLayout.vue_vue_type_style_index_0_lang-B5xXflrV.js";import"./index-B3beVsow.js";import"./index-CMWG4mbA.js";const Q={class:"container-fluid"},R={class:"row"},X={class:"col-lg-12"},Y={class:"card"},Z={class:"card-body"},ee={key:0,class:"text-center py-5"},se={key:1},te={class:"text-muted mb-3 text-uppercase"},ae={class:"row"},le={class:"card border-0 shadow-sm h-100"},ne={class:"card-body"},oe={class:"d-flex align-items-center justify-content-between mb-2"},de={class:"dropdown"},ie={class:"dropdown-menu"},re=["onClick"],ue=["onClick"],ce={class:"card-title mb-2"},me={class:"d-flex align-items-center justify-content-between"},ve={class:"text-muted"},be={class:"text-muted"},pe={class:"modal-dialog",role:"document"},fe={class:"modal-content"},ge={class:"modal-header"},_e={class:"modal-title"},ye={class:"modal-body"},he={class:"mb-3"},ke={key:0,class:"invalid-feedback"},we={class:"mb-3"},xe={key:0,class:"invalid-feedback"},Ce={class:"modal-footer"},Pe=["disabled"],Me={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},De={class:"modal-dialog",role:"document"},Se={class:"modal-content"},Ee={class:"modal-body"},Ne={class:"alert alert-warning"},Ve={class:"d-flex align-items-start"},Te={class:"mb-0 mt-2"},Ue={key:2,class:"modal-backdrop fade show"},$e=z({__name:"Permissions",props:{permissions:{}},setup(N){const P=N,b=m(!1),_=m(!1),u=m(null),p=m(null),c=m({name:"",guard_name:"web"}),d=m({}),f=m(!1);G(()=>{I(()=>{typeof feather<"u"&&feather.replace()})});const V=()=>{u.value=null,c.value={name:"",guard_name:"web"},d.value={},b.value=!0},T=t=>{u.value=t,c.value={name:t.name,guard_name:t.guard_name},d.value={},b.value=!0},U=t=>{p.value=t,_.value=!0},y=()=>{b.value=!1,u.value=null,c.value={name:"",guard_name:"web"},d.value={}},h=()=>{_.value=!1,p.value=null},M=async()=>{f.value=!0,d.value={};try{const t=u.value?`/admin/permissions/${u.value.id}`:"/admin/permissions",s=u.value?"put":"post";await k[s](t,c.value,{onSuccess:()=>{y(),k.reload()},onError:i=>{d.value=i}})}catch(t){console.error("Error submitting form:",t)}finally{f.value=!1}},$=async()=>{if(p.value)try{await k.delete(`/admin/permissions/${p.value.id}`,{onSuccess:()=>{h(),k.reload()}})}catch(t){console.error("Error deleting permission:",t)}},j=t=>t.includes("create")?"bg-success":t.includes("read")?"bg-info":t.includes("update")?"bg-warning text-dark":t.includes("delete")?"bg-danger":t.includes("manage")?"bg-primary":"bg-secondary",A=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=t=>{const s={};return t.forEach(i=>{const g=i.name.split(" "),n=g.length>1?g[0]:"General";s[n]||(s[n]=[]),s[n].push(i)}),s};return(t,s)=>(l(),a(w,null,[D(L(W),{title:"Permissions Management"}),D(K,null,{default:q(()=>[e("div",Q,[s[9]||(s[9]=e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("div",{class:"breadcrumb-main"},[e("h4",{class:"text-capitalize breadcrumb-title"},"Permissions Management")])])],-1)),e("div",R,[e("div",X,[e("div",Y,[e("div",{class:"card-header"},[e("div",{class:"d-flex align-items-center justify-content-between"},[s[3]||(s[3]=e("h5",{class:"mb-0"},[e("span",{"data-feather":"key",class:"me-2"}),o(" System Permissions ")],-1)),e("button",{onClick:V,class:"btn btn-primary"},s[2]||(s[2]=[e("span",{"data-feather":"plus",class:"me-2"},null,-1),o(" Add Permission ",-1)]))])]),e("div",Z,[P.permissions.length===0?(l(),a("div",ee,s[4]||(s[4]=[e("span",{"data-feather":"key",class:"text-muted mb-3",style:{width:"48px",height:"48px"}},null,-1),e("h6",{class:"text-muted"},"No permissions found",-1),e("p",{class:"text-muted mb-0"},'Click "Add Permission" to create your first permission.',-1)]))):(l(),a("div",se,[(l(!0),a(w,null,S(B(P.permissions),(i,g)=>(l(),a("div",{key:g,class:"mb-4"},[e("h6",te,[s[5]||(s[5]=e("span",{"data-feather":"folder",class:"me-2"},null,-1)),o(" "+r(g)+" Permissions ",1)]),e("div",ae,[(l(!0),a(w,null,S(i,n=>(l(),a("div",{key:n.id,class:"col-md-6 col-lg-4 mb-3"},[e("div",le,[e("div",ne,[e("div",oe,[e("span",{class:x(["badge",j(n.name)])},r(n.name.split(" ")[0]),3),e("div",de,[s[8]||(s[8]=e("button",{class:"btn btn-sm btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[e("span",{"data-feather":"more-vertical"})],-1)),e("ul",ie,[e("li",null,[e("button",{onClick:F=>T(n),class:"dropdown-item"},s[6]||(s[6]=[e("span",{"data-feather":"edit",class:"me-2"},null,-1),o(" Edit ",-1)]),8,re)]),e("li",null,[e("button",{onClick:F=>U(n),class:"dropdown-item text-danger"},s[7]||(s[7]=[e("span",{"data-feather":"trash-2",class:"me-2"},null,-1),o(" Delete ",-1)]),8,ue)])])])]),e("h6",ce,r(n.name),1),e("div",me,[e("small",ve,r(n.roles_count||0)+" roles ",1),e("small",be,r(A(n.created_at)),1)])])])]))),128))])]))),128))]))])])])])]),b.value?(l(),a("div",{key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:C(y,["self"])},[e("div",pe,[e("div",fe,[e("div",ge,[e("h5",_e,[s[10]||(s[10]=e("span",{"data-feather":"key",class:"me-2"},null,-1)),o(" "+r(u.value?"Edit Permission":"Create New Permission"),1)]),e("button",{type:"button",class:"btn-close",onClick:y})]),e("div",ye,[e("form",{onSubmit:C(M,["prevent"])},[e("div",he,[s[11]||(s[11]=e("label",{for:"permissionName",class:"form-label"},"Permission Name",-1)),E(e("input",{id:"permissionName","onUpdate:modelValue":s[0]||(s[0]=i=>c.value.name=i),type:"text",class:x(["form-control",{"is-invalid":d.value.name}]),placeholder:"e.g., create users, manage roles",required:""},null,2),[[H,c.value.name]]),d.value.name?(l(),a("div",ke,r(d.value.name),1)):v("",!0),s[12]||(s[12]=e("div",{class:"form-text"},' Use descriptive names like "create users", "manage roles", etc. ',-1))]),e("div",we,[s[14]||(s[14]=e("label",{for:"guardName",class:"form-label"},"Guard Name",-1)),E(e("select",{id:"guardName","onUpdate:modelValue":s[1]||(s[1]=i=>c.value.guard_name=i),class:x(["form-select",{"is-invalid":d.value.guard_name}])},s[13]||(s[13]=[e("option",{value:"web"},"Web",-1),e("option",{value:"api"},"API",-1)]),2),[[J,c.value.guard_name]]),d.value.guard_name?(l(),a("div",xe,r(d.value.guard_name),1)):v("",!0)])],32)]),e("div",Ce,[e("button",{type:"button",class:"btn btn-secondary",onClick:y}," Cancel "),e("button",{type:"button",class:"btn btn-primary",onClick:M,disabled:f.value},[f.value?(l(),a("span",Me)):v("",!0),s[15]||(s[15]=e("span",{"data-feather":"save",class:"me-2"},null,-1)),o(" "+r(f.value?"Saving...":u.value?"Update Permission":"Create Permission"),1)],8,Pe)])])])])):v("",!0),_.value?(l(),a("div",{key:1,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:C(h,["self"])},[e("div",De,[e("div",Se,[e("div",{class:"modal-header"},[s[16]||(s[16]=e("h5",{class:"modal-title text-danger"},[e("span",{"data-feather":"alert-triangle",class:"me-2"}),o(" Delete Permission ")],-1)),e("button",{type:"button",class:"btn-close",onClick:h})]),e("div",Ee,[e("div",Ne,[e("div",Ve,[s[21]||(s[21]=e("span",{"data-feather":"alert-triangle",class:"me-2 mt-1"},null,-1)),e("div",null,[s[19]||(s[19]=e("strong",null,"Warning:",-1)),s[20]||(s[20]=o(" This action cannot be undone. ",-1)),e("p",Te,[s[17]||(s[17]=o(" Are you sure you want to delete the permission ",-1)),e("strong",null,'"'+r(p.value?.name)+'"',1),s[18]||(s[18]=o("? This will remove the permission from all roles. ",-1))])])])])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:h}," Cancel "),e("button",{type:"button",class:"btn btn-danger",onClick:$},s[22]||(s[22]=[e("span",{"data-feather":"trash-2",class:"me-2"},null,-1),o(" Delete Permission ",-1)]))])])])])):v("",!0),b.value||_.value?(l(),a("div",Ue)):v("",!0)]),_:1})],64))}}),ze=O($e,[["__scopeId","data-v-14a5026f"]]);export{ze as default};
