import{d as F,r as m,c as a,o as l,a as M,u as G,h as I,w as L,b as e,e as v,f as n,F as h,g as S,t as r,n as x,i as C,j as E,v as W,k as q,l as w}from"./app-Dvg2MEOR.js";import{_ as H,a as J}from"./StrikingDashLayout.vue_vue_type_style_index_0_lang-DDLh7G2A.js";import"./index-B3beVsow.js";import"./index-CMWG4mbA.js";import"./assets-CRnoQADB.js";const K={class:"container-fluid"},O={class:"row"},Q={class:"col-lg-12"},R={class:"card"},X={class:"card-body"},Y={key:0,class:"text-center py-5"},Z={key:1},ee={class:"text-muted mb-3 text-uppercase"},se={class:"row"},te={class:"card border-0 shadow-sm h-100"},ae={class:"card-body"},le={class:"d-flex align-items-center justify-content-between mb-2"},oe={class:"dropdown"},ne={class:"dropdown-menu"},ie=["onClick"],de=["onClick"],re={class:"card-title mb-2"},ue={class:"d-flex align-items-center justify-content-between"},ce={class:"text-muted"},me={class:"text-muted"},ve={class:"modal-dialog",role:"document"},be={class:"modal-content"},fe={class:"modal-header"},pe={class:"modal-title"},ge={class:"modal-body"},_e={class:"mb-3"},ye={key:0,class:"invalid-feedback"},ke={class:"mb-3"},we={key:0,class:"invalid-feedback"},he={class:"modal-footer"},xe=["disabled"],Ce={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},Pe={class:"modal-dialog",role:"document"},De={class:"modal-content"},Me={class:"modal-body"},Se={class:"alert alert-warning"},Ee={class:"d-flex align-items-start"},Ne={class:"mb-0 mt-2"},Ve={key:2,class:"modal-backdrop fade show"},Ue=F({__name:"Permissions",props:{permissions:{}},setup(N){const P=N,b=m(!1),_=m(!1),u=m(null),f=m(null),c=m({name:"",guard_name:"web"}),i=m({}),p=m(!1),V=()=>{u.value=null,c.value={name:"",guard_name:"web"},i.value={},b.value=!0},U=t=>{u.value=t,c.value={name:t.name,guard_name:t.guard_name},i.value={},b.value=!0},$=t=>{f.value=t,_.value=!0},y=()=>{b.value=!1,u.value=null,c.value={name:"",guard_name:"web"},i.value={}},k=()=>{_.value=!1,f.value=null},D=async()=>{p.value=!0,i.value={};try{const t=u.value?`/admin/permissions/${u.value.id}`:"/admin/permissions",s=u.value?"put":"post";await w[s](t,c.value,{onSuccess:()=>{y(),w.reload()},onError:d=>{i.value=d}})}catch(t){console.error("Error submitting form:",t)}finally{p.value=!1}},j=async()=>{if(f.value)try{await w.delete(`/admin/permissions/${f.value.id}`,{onSuccess:()=>{k(),w.reload()}})}catch(t){console.error("Error deleting permission:",t)}},A=t=>t.includes("create")?"bg-success":t.includes("read")?"bg-info":t.includes("update")?"bg-warning text-dark":t.includes("delete")?"bg-danger":t.includes("manage")?"bg-primary":"bg-secondary",B=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=t=>{const s={};return t.forEach(d=>{const g=d.name.split(" "),o=g.length>1?g[0]:"General";s[o]||(s[o]=[]),s[o].push(d)}),s};return(t,s)=>(l(),a(h,null,[M(G(I),{title:"Permissions Management"}),M(H,null,{default:L(()=>[e("div",K,[s[9]||(s[9]=e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("div",{class:"breadcrumb-main"},[e("h4",{class:"text-capitalize breadcrumb-title"},"Permissions Management")])])],-1)),e("div",O,[e("div",Q,[e("div",R,[e("div",{class:"card-header"},[e("div",{class:"d-flex align-items-center justify-content-between"},[s[3]||(s[3]=e("h5",{class:"mb-0"},[e("i",{class:"fas fa-key me-2"}),n(" System Permissions ")],-1)),e("button",{onClick:V,class:"btn btn-primary"},s[2]||(s[2]=[e("i",{class:"fas fa-plus me-2"},null,-1),n(" Add Permission ",-1)]))])]),e("div",X,[P.permissions.length===0?(l(),a("div",Y,s[4]||(s[4]=[e("i",{class:"fas fa-key text-muted mb-3",style:{"font-size":"48px"}},null,-1),e("h6",{class:"text-muted"},"No permissions found",-1),e("p",{class:"text-muted mb-0"},'Click "Add Permission" to create your first permission.',-1)]))):(l(),a("div",Z,[(l(!0),a(h,null,S(T(P.permissions),(d,g)=>(l(),a("div",{key:g,class:"mb-4"},[e("h6",ee,[s[5]||(s[5]=e("i",{class:"fas fa-folder me-2"},null,-1)),n(" "+r(g)+" Permissions ",1)]),e("div",se,[(l(!0),a(h,null,S(d,o=>(l(),a("div",{key:o.id,class:"col-md-6 col-lg-4 mb-3"},[e("div",te,[e("div",ae,[e("div",le,[e("span",{class:x(["badge",A(o.name)])},r(o.name.split(" ")[0]),3),e("div",oe,[s[8]||(s[8]=e("button",{class:"btn btn-sm btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},[e("i",{class:"fas fa-ellipsis-v"})],-1)),e("ul",ne,[e("li",null,[e("button",{onClick:z=>U(o),class:"dropdown-item"},s[6]||(s[6]=[e("i",{class:"fas fa-edit me-2"},null,-1),n(" Edit ",-1)]),8,ie)]),e("li",null,[e("button",{onClick:z=>$(o),class:"dropdown-item text-danger"},s[7]||(s[7]=[e("i",{class:"fas fa-trash me-2"},null,-1),n(" Delete ",-1)]),8,de)])])])]),e("h6",re,r(o.name),1),e("div",ue,[e("small",ce,r(o.roles_count||0)+" roles ",1),e("small",me,r(B(o.created_at)),1)])])])]))),128))])]))),128))]))])])])])]),b.value?(l(),a("div",{key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:C(y,["self"])},[e("div",ve,[e("div",be,[e("div",fe,[e("h5",pe,[s[10]||(s[10]=e("i",{class:"fas fa-key me-2"},null,-1)),n(" "+r(u.value?"Edit Permission":"Create New Permission"),1)]),e("button",{type:"button",class:"btn-close",onClick:y})]),e("div",ge,[e("form",{onSubmit:C(D,["prevent"])},[e("div",_e,[s[11]||(s[11]=e("label",{for:"permissionName",class:"form-label"},"Permission Name",-1)),E(e("input",{id:"permissionName","onUpdate:modelValue":s[0]||(s[0]=d=>c.value.name=d),type:"text",class:x(["form-control",{"is-invalid":i.value.name}]),placeholder:"e.g., create users, manage roles",required:""},null,2),[[W,c.value.name]]),i.value.name?(l(),a("div",ye,r(i.value.name),1)):v("",!0),s[12]||(s[12]=e("div",{class:"form-text"},' Use descriptive names like "create users", "manage roles", etc. ',-1))]),e("div",ke,[s[14]||(s[14]=e("label",{for:"guardName",class:"form-label"},"Guard Name",-1)),E(e("select",{id:"guardName","onUpdate:modelValue":s[1]||(s[1]=d=>c.value.guard_name=d),class:x(["form-select",{"is-invalid":i.value.guard_name}])},s[13]||(s[13]=[e("option",{value:"web"},"Web",-1),e("option",{value:"api"},"API",-1)]),2),[[q,c.value.guard_name]]),i.value.guard_name?(l(),a("div",we,r(i.value.guard_name),1)):v("",!0)])],32)]),e("div",he,[e("button",{type:"button",class:"btn btn-secondary",onClick:y}," Cancel "),e("button",{type:"button",class:"btn btn-primary",onClick:D,disabled:p.value},[p.value?(l(),a("span",Ce)):v("",!0),s[15]||(s[15]=e("i",{class:"fas fa-save me-2"},null,-1)),n(" "+r(p.value?"Saving...":u.value?"Update Permission":"Create Permission"),1)],8,xe)])])])])):v("",!0),_.value?(l(),a("div",{key:1,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:C(k,["self"])},[e("div",Pe,[e("div",De,[e("div",{class:"modal-header"},[s[16]||(s[16]=e("h5",{class:"modal-title text-danger"},[e("i",{class:"fas fa-exclamation-triangle me-2"}),n(" Delete Permission ")],-1)),e("button",{type:"button",class:"btn-close",onClick:k})]),e("div",Me,[e("div",Se,[e("div",Ee,[s[21]||(s[21]=e("i",{class:"fas fa-exclamation-triangle me-2 mt-1"},null,-1)),e("div",null,[s[19]||(s[19]=e("strong",null,"Warning:",-1)),s[20]||(s[20]=n(" This action cannot be undone. ",-1)),e("p",Ne,[s[17]||(s[17]=n(" Are you sure you want to delete the permission ",-1)),e("strong",null,'"'+r(f.value?.name)+'"',1),s[18]||(s[18]=n("? This will remove the permission from all roles. ",-1))])])])])]),e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary",onClick:k}," Cancel "),e("button",{type:"button",class:"btn btn-danger",onClick:j},s[22]||(s[22]=[e("i",{class:"fas fa-trash me-2"},null,-1),n(" Delete Permission ",-1)]))])])])])):v("",!0),b.value||_.value?(l(),a("div",Ve)):v("",!0)]),_:1})],64))}}),ze=J(Ue,[["__scopeId","data-v-4afc687f"]]);export{ze as default};
