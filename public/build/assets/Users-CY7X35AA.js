import{d as $,r as f,o as D,q as _,c as o,a as l,b as v,u as g,h as j,w as q,e,f as h,g as m,F as y,i as C,t as c,j as L,k as E,p as N}from"./app-C8I2FI9v.js";import{_ as R,a as T}from"./StrikingDashLayout.vue_vue_type_style_index_0_lang-B5xXflrV.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-BhDB-aqQ.js";import"./index-B3beVsow.js";import"./index-CMWG4mbA.js";import"./utils-TfETDaq2.js";import"./index-x9fwfB49.js";const B={class:"container-fluid"},F={class:"card border-0 shadow-sm"},z={class:"card-body p-0"},I={class:"table-responsive"},O={class:"table table-hover mb-0"},P={class:"border-0"},J={class:"d-flex align-items-center"},K={class:"me-3"},X=["src","alt"],G={key:1,class:"avatar-title bg-primary bg-gradient rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"}},H={class:"text-white fw-semibold"},Q={class:"mb-0 fw-semibold"},W={class:"border-0"},Y={class:"d-flex align-items-center"},Z={class:"text-dark"},ee={class:"border-0"},se={key:0},te={key:1},ae={key:2,class:"badge bg-light text-dark border"},oe={class:"border-0"},le={class:"d-flex align-items-center"},de={class:"text-dark"},re={class:"border-0"},ne={class:"d-flex gap-2"},ie=["onClick"],ce=["onClick","disabled","title"],me={key:0},ue={class:"modal-dialog modal-dialog-centered",role:"document"},pe={class:"modal-content"},be={class:"modal-header"},fe={class:"modal-title"},_e={class:"modal-body"},ve={class:"mb-3"},he={class:"mb-3"},ge={class:"mb-3"},ye={for:"password",class:"form-label"},we={key:0,class:"text-muted"},ke={class:"modal-footer"},xe=["disabled"],Ue={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},Ce=$({__name:"Users",props:{users:{}},setup(V){const k=V,u=f(!1),n=f(!1),p=f(!1),r=f({user_id:null,name:"",email:"",password:""}),x=f("");D(()=>{const a=document.querySelector('meta[name="csrf-token"]');a&&(x.value=a.getAttribute("content")||""),_.defaults.headers.common["X-CSRF-TOKEN"]=x.value,_.defaults.headers.common["Content-Type"]="application/json",_.defaults.headers.common.Accept="application/json"});const b=()=>{u.value=!1,r.value={user_id:null,name:"",email:"",password:""},document.body.classList.remove("modal-open")},A=()=>{n.value=!1,r.value={user_id:null,name:"",email:"",password:""},u.value=!0,document.body.classList.add("modal-open")},S=a=>{n.value=!0,r.value={user_id:a.id,name:a.name,email:a.email,password:""},u.value=!0,document.body.classList.add("modal-open")},U=async()=>{try{p.value=!0;const a=n.value?`/admin/users/${r.value.user_id}`:"/admin/users",s=n.value?"put":"post",t=await _[s](a,r.value);t.data.success?(i(t.data.message,"success"),b(),N.reload()):i(t.data.message,"error")}catch(a){console.error("Error saving user:",a),a.response?.data?.errors?i("Validation errors: "+JSON.stringify(a.response.data.errors),"error"):i(a.response?.data?.message||"Error saving user","error")}finally{p.value=!1}},M=async a=>{if(confirm("Are you sure you want to delete this user?"))try{const s=await _.delete(`/admin/users/${a}`);s.data.success?(i(s.data.message,"success"),N.reload()):i(s.data.message,"error")}catch(s){console.error("Error deleting user:",s),i(s.response?.data?.message||"Error deleting user","error")}},i=(a,s)=>{alert(`${s.toUpperCase()}: ${a}`)};return(a,s)=>(l(),o(y,null,[v(g(j),{title:"User Management"}),v(R,null,{default:q(()=>[e("div",B,[e("div",{class:"row"},[e("div",{class:"col-lg-12"},[e("div",{class:"breadcrumb-main d-flex align-items-center justify-content-between"},[s[4]||(s[4]=e("h4",{class:"text-capitalize breadcrumb-title mb-0"},"User Management",-1)),e("button",{onClick:A,class:"btn btn-primary"},s[3]||(s[3]=[e("span",{"data-feather":"plus",class:"me-2"},null,-1),m(" Add User ",-1)]))])])]),e("div",F,[s[13]||(s[13]=e("div",{class:"card-header bg-white border-bottom"},[e("h5",{class:"mb-0 d-flex align-items-center"},[e("span",{"data-feather":"users",class:"me-2 text-primary"}),m(" Users List ")])],-1)),e("div",z,[e("div",I,[e("table",O,[s[12]||(s[12]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{class:"border-0 fw-semibold"},"User"),e("th",{class:"border-0 fw-semibold"},"Email"),e("th",{class:"border-0 fw-semibold"},"Role"),e("th",{class:"border-0 fw-semibold"},"Status"),e("th",{class:"border-0 fw-semibold"},"Created"),e("th",{class:"border-0 fw-semibold"},"Actions")])],-1)),e("tbody",null,[(l(!0),o(y,null,C(k.users,t=>(l(),o("tr",{key:t.id,class:"align-middle"},[e("td",P,[e("div",J,[e("div",K,[t.profile_photo_url?(l(),o("img",{key:0,src:t.profile_photo_url,alt:t.name||"User",class:"rounded-circle",style:{width:"40px",height:"40px","object-fit":"cover"}},null,8,X)):(l(),o("div",G,[e("span",H,c(t.name?t.name.charAt(0).toUpperCase():"U"),1)]))]),e("div",null,[e("h6",Q,c(t.name||"No Name"),1)])])]),e("td",W,[e("div",Y,[s[5]||(s[5]=e("span",{"data-feather":"mail",class:"me-2 text-muted"},null,-1)),e("span",Z,c(t.email||"No Email"),1)])]),e("td",ee,[t.id===1?(l(),o("div",se,s[6]||(s[6]=[e("span",{class:"badge bg-danger me-1"}," SUPER ADMIN ",-1)]))):t.roles&&t.roles.length>0?(l(),o("div",te,[(l(!0),o(y,null,C(t.roles,d=>(l(),o("span",{key:d.name,class:L(["badge me-1",{"bg-danger":d.name==="super-admin","bg-warning text-dark":d.name==="admin","bg-primary":d.name==="user","bg-secondary":!["super-admin","admin","user"].includes(d.name)}])},c(d.name.replace("-"," ").toUpperCase()),3))),128))])):(l(),o("span",ae," No Role "))]),s[10]||(s[10]=e("td",{class:"border-0"},[e("span",{class:"badge bg-success"}," Active ")],-1)),e("td",oe,[e("div",le,[s[7]||(s[7]=e("span",{"data-feather":"calendar",class:"me-2 text-muted"},null,-1)),e("span",de,c(t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown"),1)])]),e("td",re,[e("div",ne,[e("button",{onClick:d=>S(t),class:"btn btn-outline-primary btn-sm",title:"Edit User"},s[8]||(s[8]=[e("span",{"data-feather":"edit",class:"me-1"},null,-1),m(" Edit ",-1)]),8,ie),e("button",{onClick:d=>M(t.id),class:"btn btn-outline-danger btn-sm",disabled:t.roles&&t.roles.some(d=>d.name==="super-admin"),title:t.roles&&t.roles.some(d=>d.name==="super-admin")?"Cannot delete super admin":"Delete User"},s[9]||(s[9]=[e("span",{"data-feather":"trash-2",class:"me-1"},null,-1),m(" Delete ",-1)]),8,ce)])])]))),128)),k.users.length===0?(l(),o("tr",me,s[11]||(s[11]=[e("td",{colspan:"6",class:"text-center py-5"},[e("div",{class:"d-flex flex-column align-items-center"},[e("span",{"data-feather":"users",class:"text-muted mb-3",style:{width:"48px",height:"48px"}}),e("h6",{class:"text-muted"},"No users found"),e("p",{class:"text-muted mb-0"},'Click "Add User" to create your first user.')])],-1)]))):h("",!0)])])])])]),u.value?(l(),o("div",{key:0,class:"modal fade show",style:{display:"block"},tabindex:"-1",role:"dialog",onClick:E(b,["self"])},[e("div",ue,[e("div",pe,[e("div",be,[e("h5",fe,c(n.value?"Edit User":"Add New User"),1),e("button",{type:"button",class:"btn-close",onClick:b,"aria-label":"Close"})]),e("div",_e,[e("form",{onSubmit:E(U,["prevent"])},[e("div",ve,[s[14]||(s[14]=e("label",{for:"name",class:"form-label"},"Name",-1)),v(g(w),{id:"name",modelValue:r.value.name,"onUpdate:modelValue":s[0]||(s[0]=t=>r.value.name=t),type:"text",class:"form-control",required:"",placeholder:"Enter user name"},null,8,["modelValue"])]),e("div",he,[s[15]||(s[15]=e("label",{for:"email",class:"form-label"},"Email",-1)),v(g(w),{id:"email",modelValue:r.value.email,"onUpdate:modelValue":s[1]||(s[1]=t=>r.value.email=t),type:"email",class:"form-control",required:"",placeholder:"Enter email address"},null,8,["modelValue"])]),e("div",ge,[e("label",ye,[s[16]||(s[16]=m(" Password ",-1)),n.value?(l(),o("span",we,"(leave blank to keep current)")):h("",!0)]),v(g(w),{id:"password",modelValue:r.value.password,"onUpdate:modelValue":s[2]||(s[2]=t=>r.value.password=t),type:"password",class:"form-control",required:!n.value,placeholder:"Enter password"},null,8,["modelValue","required"])])],32)]),e("div",ke,[e("button",{type:"button",class:"btn btn-secondary",onClick:b}," Cancel "),e("button",{type:"button",class:"btn btn-primary",onClick:U,disabled:p.value},[p.value?(l(),o("span",Ue)):h("",!0),m(" "+c(p.value?"Saving...":n.value?"Update":"Create"),1)],8,xe)])])])])):h("",!0),u.value?(l(),o("div",{key:1,class:"modal-backdrop fade show",onClick:b})):h("",!0)])]),_:1})],64))}}),De=T(Ce,[["__scopeId","data-v-bde03a40"]]);export{De as default};
